
        <dashboard version="2" theme="dark">
            <label>Laundry Base DS</label>
            <description></description>
            <definition><![CDATA[{"visualizations":{"viz_single_1":{"type":"splunk.singlevalue","options":{"colorMode":"block","drilldown":"none","numberPrecision":0,"refresh.display":"progressbar","sparklineDisplay":"off","trendDisplay":"absolute","trellis.enabled":0,"trellis.scales.shared":1,"trellis.size":"medium","unit":"Min","unitPosition":"after","shouldUseThousandSeparators":true,"backgroundColor":"transparent","majorColor":"#53a051"},"dataSources":{"primary":"ds_search_1"},"title":"Zuletzt gestartet vor:","context":{"convertedColorRange":[{"from":120,"value":"#006d9c"},{"from":70,"to":120,"value":"#f1813f"},{"from":60,"to":70,"value":"#f8be34"},{"from":0,"to":60,"value":"#0877a6"},{"to":0,"value":"#53a051"}]}},"viz_single_2":{"type":"splunk.singlevalue","options":{"colorMode":"block","drilldown":"none","numberPrecision":0,"refresh.display":"progressbar","backgroundColor":"transparent","majorColor":"#0877a6"},"dataSources":{"primary":"ds_search_2"},"title":"Dauer des letzten Waschvorgangs in Min:","context":{"convertedColorRange":[{"from":200,"value":"#dc4e41"},{"from":100,"to":200,"value":"#006d9c"},{"from":60,"to":100,"value":"#f1813f"},{"from":30,"to":60,"value":"#f8be34"},{"from":0,"to":30,"value":"#0877a6"},{"to":0,"value":"#53a051"}]}},"viz_single_3":{"type":"splunk.singlevalue","options":{"colorMode":"block","drilldown":"none","refresh.display":"progressbar","backgroundColor":"transparent","sparklineDisplay":"off","majorColor":"#62b3b2"},"dataSources":{"primary":"ds_search_3"},"title":"Das letzte Mal fertig","context":{"convertedColorRange":[{"from":100,"value":"#dc4e41"},{"from":70,"to":100,"value":"#f1813f"},{"from":30,"to":70,"value":"#f8be34"},{"from":0,"to":30,"value":"#0877a6"},{"to":0,"value":"#53a051"}]}},"viz_chart_1":{"type":"viz.area","options":{"axisLabelsX.majorLabelStyle.overflowMode":"ellipsisNone","axisLabelsX.majorLabelStyle.rotation":0,"axisTitleX.visibility":"visible","axisTitleY.visibility":"visible","axisTitleY2.visibility":"visible","axisX.abbreviation":"none","axisX.scale":"linear","axisY.abbreviation":"none","axisY.scale":"linear","axisY2.abbreviation":"auto","axisY2.enabled":1,"axisY2.scale":"log","chart.bubbleMaximumSize":50,"chart.bubbleMinimumSize":10,"chart.bubbleSizeBy":"area","chart.nullValueMode":"gaps","chart.overlayFields":"LaundryState","chart.showDataLabels":"none","chart.sliceCollapsingThreshold":0.01,"chart.stackMode":"default","chart.style":"shiny","drilldown":"none","layout.splitSeries":0,"layout.splitSeries.allowIndependentYRanges":0,"legend.labelStyle.overflowMode":"ellipsisMiddle","legend.mode":"standard","legend.placement":"none","lineWidth":1,"seriesColors":"[#0074D9, \"0x53a051\",\"0x0877a6\",\"0xf8be34\",\"0xf1813f\",\"0x006d9c\"]","refresh.display":"progressbar","trellis.enabled":0,"trellis.scales.shared":1,"trellis.size":"medium"},"dataSources":{"primary":"ds_search_4","annotation":"ds_search_5"},"title":"Timechart Laundry","encoding":{"annotationX":"annotation._time","annotationLabel":"annotation.annotation_label","annotationCategory":"annotation.annotation_category","annotationColor":{"field":"annotation.annotation_category","format":{"categories":["INFO","WARN"],"values":["#8B0000","#0074D9"]}}}}},"dataSources":{"ds_LaundryBase":{"type":"ds.search","options":{"query":"\n      | mstats avg(\"tplink.hs110.power\") prestats=true WHERE \"index\"=\"tplink_metrics\" AND \"inputname\"=\"Wash\" span=1m\n    ","queryParameters":{"earliest":"-3d","latest":"now"},"refresh":"1m","refreshType":"delay"},"name":"ds_LaundryBase"},"ds_search_1":{"type":"ds.chain","options":{"query":"\n| timechart avg(\"tplink.hs110.power\") AS Power span=10m \n| delta Power AS DeltaPower p=1\n| delta DeltaPower AS Delta2Power p=1\n| delta Delta2Power AS Delta3Power p=1\n| eval DeltaSum=Power+DeltaPower+Delta2Power\n| eval LaundryState = if(((DeltaSum>10 OR DeltaSum<-10) AND Power>10), \"100\",\"-100\")\n| delta LaundryState AS LaundryChange\n| fields - Power, Delta2Power, Delta3Power, DeltaPower, DeltaSums\n| eval ONOFF=case(LaundryChange == 200, \"On\", LaundryChange == -200, \"Off\")\n| search ONOFF=On OR ONOFF=Off\n| eval start_time=if(ONOFF==\"On\",_time,null()), end_time=if(ONOFF==\"Off\",_time,null())\n| stats latest(start_time) as start_time,latest(end_time) as end_time \n| eval LastStart=floor(abs(now()-start_time)/60)\n| fields LastStart","extend":"ds_LaundryBase"}},"ds_search_2":{"type":"ds.chain","options":{"query":"| timechart avg(\"tplink.hs110.power\") AS Power span=10m \n| delta Power AS DeltaPower p=1\n| delta DeltaPower AS Delta2Power p=1\n| delta Delta2Power AS Delta3Power p=1\n| eval DeltaSum=Power+DeltaPower+Delta2Power\n| eval LaundryState = if(((DeltaSum>10 OR DeltaSum<-10) AND Power>10), \"100\",\"-100\")\n| delta LaundryState AS LaundryChange\n| eval ONOFF=case(LaundryChange == 200, \"On\", LaundryChange == -200, \"Off\")\n| search ONOFF=On OR ONOFF=Off\n| eval start_time=if(ONOFF==\"On\",_time,null()), end_time=if(ONOFF==\"Off\",_time,null())\n| stats latest(start_time) as start_time,latest(end_time) as end_time \n| eval Dauer=case(end_time<start_time, \"LÃ¤uft\", isnotnull(end_time) ,(abs(end_time-start_time)/60), 1=1, \"Ungewiss\")\n| fields Dauer","extend":"ds_LaundryBase"}},"ds_search_3":{"type":"ds.chain","options":{"query":"\n| timechart avg(\"tplink.hs110.power\") AS Power span=10m \n| delta Power AS DeltaPower p=1\n| delta DeltaPower AS Delta2Power p=1\n| delta Delta2Power AS Delta3Power p=1\n| eval DeltaSum=Power+DeltaPower+Delta2Power\n| eval LaundryState = if(((DeltaSum>10 OR DeltaSum<-10) AND Power>10), \"100\",\"-100\")\n| delta LaundryState AS LaundryChange\n| fields - Power, Delta2Power, Delta3Power, DeltaPower, DeltaSums\n| eval ONOFF=case(LaundryChange == 200, \"On\", LaundryChange == -200, \"Off\")\n| search ONOFF=On OR ONOFF=Off\n| eval last_checked=_time\n| eval now=time(), last_checked=case((last_checked > now),\"0 minutes ago\",((now - last_checked) > 172800),(round(((now - last_checked) / 86400)) . \" days ago\"),((now - last_checked) > 7200),(round(((now - last_checked) / 3600)) . \" hours ago\"),((now - last_checked) > 120),(round(((now - last_checked) / 60)) . \" minutes ago\"),((now - last_checked) > 60),\"1 minute ago\",((now - last_checked) <= 60),\"just now\")\n| eval start_time=if(ONOFF==\"On\",_time,null()), end_time=if(ONOFF==\"Off\",_time,null())\n| search ONOFF=\"Off\"\n| sort - _time\n| head 1\n| rename last_checked AS \"LastOff\"\n| fields \"LastOff\"","extend":"ds_LaundryBase"}},"ds_search_4":{"type":"ds.chain","options":{"query":"| timechart avg(\"tplink.hs110.power\") AS Power span=5m \n| autoregress  Power p=1-10\n| eval  moving_average=(Power  + Power_p1 + Power_p2 + Power_p3 + Power_p4 + Power_p5 + Power_p6 + Power_p7 + Power_p8 + Power_p9) /10 \n| fields _time Power moving_average\n| eval LaundryState = if(moving_average>10, \"100\",\"-100\")","extend":"ds_LaundryBase"}},"ds_search_5":{"type":"ds.search","options":{"query":"index=main source=\"alert:Laundry Ready\" | eval annotation_category=\"INFO\" | eval annotation_label=\"Alert was sent to mobile\"","queryParameters":{"earliest":"-3d@h","latest":"now"}}}},"defaults":{"dataSources":{"ds.search":{"options":{"queryParameters":{}}}}},"inputs":{},"layout":{"type":"absolute","options":{"display":"auto-scale","height":537},"structure":[{"item":"viz_single_1","type":"block","position":{"x":0,"y":0,"w":400,"h":250}},{"item":"viz_single_2","type":"block","position":{"x":400,"y":0,"w":400,"h":250}},{"item":"viz_single_3","type":"block","position":{"x":800,"y":0,"w":400,"h":250}},{"item":"viz_chart_1","type":"block","position":{"x":0,"y":250,"w":1200,"h":287}}],"globalInputs":[]},"description":"","title":"Laundry Base DS"}]]></definition>
            <assets><![CDATA[{}]]></assets>
        </dashboard>